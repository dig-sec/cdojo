Vagrant.configure("2") do |config|
    config.vm.define "windows-server" do |server|
      server.vm.box = "windows-server-2022"
  
      server.vm.provider :libvirt do |libvirt|
        libvirt.driver = "kvm"
        libvirt.memory = 8192
        libvirt.cpus = 4
      end
    
      # dhcp address network configuration
      server.vm.network "private_network", type: "bridge", bridge: "virbr0", ip: "192.168.122.99"
      # Uncomment and adjust the port forwarding as needed
      # server.vm.network "forwarded_port", guest: 3389, host: 3389, id: "rdp" 

      # Shell echo hello world
      server.vm.provision "shell", inline: "echo Hello World"
        
      # If using WinRM for provisioning:
      server.vm.communicator = "winrm"
      server.winrm.username = "vagrant"
      server.winrm.password = "vagrant"
      server.winrm.transport = :plaintext
      server.winrm.timeout = 1800
    end
  end
  